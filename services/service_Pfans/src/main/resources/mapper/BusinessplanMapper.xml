<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.nt.service_pfans.PFANS1000.mapper.BusinessplanMapper">
    <select id="getAcutal" resultType="com.nt.dao_Pfans.PFANS1000.Vo.ActualPL">
            select code,
       MAX(CASE a.month WHEN 4 THEN a.rmb ELSE 0 END) AS 'actual4',
       MAX(CASE a.month WHEN 5 THEN a.rmb ELSE 0 END) AS 'actual5',
       MAX(CASE a.month WHEN 6 THEN a.rmb ELSE 0 END) AS 'actual6',
       MAX(CASE a.month WHEN 7 THEN a.rmb ELSE 0 END) AS 'actual7',
       MAX(CASE a.month WHEN 8 THEN a.rmb ELSE 0 END) AS 'actual8',
       MAX(CASE a.month WHEN 9 THEN a.rmb ELSE 0 END) AS 'actual9',
       MAX(CASE a.month WHEN 10 THEN a.rmb ELSE 0 END) AS 'actual10',
       MAX(CASE a.month WHEN 11 THEN a.rmb ELSE 0 END) AS 'actual11',
       MAX(CASE a.month WHEN 12 THEN a.rmb ELSE 0 END) AS 'actual12',
       MAX(CASE a.month WHEN 1 THEN a.rmb ELSE 0 END) AS 'actual1',
       MAX(CASE a.month WHEN 2 THEN a.rmb ELSE 0 END) AS 'actual2',
       MAX(CASE a.month WHEN 3 THEN a.rmb ELSE 0 END) AS 'actual3'
    from
(
select code, sum(rmb) as rmb, month from (
select d.CODE, (IFNULL(SUM(t.RMB +t.tormb), 0) + IFNULL(SUM(pur.RMB +t.tormb), 0) + IFNULL(SUM(o.RMB +t.tormb), 0)) as rmb,MONTH(p.REIMBURSEMENTDATE) as month
from (
select `CODE` from dictionary where PCODE = 'PJ111'
) as d left join publicexpense p on 1=1
left JOIN trafficdetails t
                   on p.PUBLICEXPENSE_ID = t.PUBLICEXPENSE_ID
                       and t.PLSUMMARY  = d.CODE
                       and t.DEPARTMENTNAME = #{groupid}
         left JOIN purchasedetails pur
                   on p.PUBLICEXPENSE_ID = pur.PUBLICEXPENSE_ID
                       and pur.PLSUMMARY = d.CODE
                       and pur.DEPARTMENTNAME = #{groupid}
         left JOIN otherdetails o
                   on p.PUBLICEXPENSE_ID = o.PUBLICEXPENSE_ID
                       and o.PLSUMMARY = d.CODE
                       and o.DEPARTMENTNAME = #{groupid}
where p.REIMBURSEMENTDATE &gt;= #{startday} and p.REIMBURSEMENTDATE &lt;= #{endday}
group by MONTH(p.REIMBURSEMENTDATE), d.CODE

union all

select 'PJ111008', (IFNULL(SUM(t.RMB +t.tormb), 0) + IFNULL(SUM(a.RMB), 0) + IFNULL(SUM(o.RMB +t.tormb), 0)) as rmb,MONTH(e.REIMBURSEMENTDATE) as month
from evection e
		left join trafficdetails t
                   on e.EVECTION_ID = t.PUBLICEXPENSE_ID
                       and t.PLSUMMARY  = 'PJ111008'
                       and t.DEPARTMENTNAME = #{groupid}
         left JOIN accommodationdetails a
                   on e.EVECTION_ID = a.EVECTION_ID
                       and a.PLSUMMARY = 'PJ111008'
                       and a.DEPARTMENTNAME = #{groupid}
         left JOIN otherdetails o
                   on e.EVECTION_ID = o.PUBLICEXPENSE_ID
                       and o.PLSUMMARY = 'PJ111008'
                       and o.DEPARTMENTNAME = #{groupid}
 where e.REIMBURSEMENTDATE &gt;= #{startday} and e.REIMBURSEMENTDATE &lt;= #{endday}
group by MONTH(e.REIMBURSEMENTDATE)
) pj group by code, month

union all
select 'neibuhetong' as code,SUM(CLAIMAMOUNT) as rmb, MONTH(contract.DELIVERYDATE) as month
from contractnumbercount contract
inner join companyprojects company
on company.COMPANYPROJECTS_ID = contract.COMPANYPROJECTSID
where company.GROUP_ID = "58D1EE595EB8A700F3E75125576D5B7D0A41"
and contract.DELIVERYDATE &gt;= #{startday} and contract.DELIVERYDATE &lt;= #{endday}
GROUP BY MONTH(contract.DELIVERYDATE)

union all
select
case
when contracttype = 'HT008009' then 'HT008009'
when contracttype in ("HT008007","HT008008") then 'HT008008'
when contracttype in ("HT008001","HT008002","HT008003","HT008004","HT008005","HT008006") then 'HT008006'
else NULL
end as contracttype1,
SUM(cn.CLAIMAMOUNT) as rmb,MONTH(cn.DELIVERYDATE) as month
from contractapplication ca
inner join contractnumbercount cn
on ca.CONTRACTNUMBER = cn.CONTRACTNUMBER
where ca.state='有效'
and ca.type = "1"
and ca.GROUP_ID = #{groupid}
and cn.DELIVERYDATE &gt;= #{startday} and cn.DELIVERYDATE &lt;= #{endday}
GROUP BY MONTH(cn.DELIVERYDATE), contracttype1
having contracttype1 is not null

union all

select 'worktime', SUM(l.TIME_START) as worktime ,MONTH(l.LOG_DATE) as month from logmanagement l
inner join companyprojects c
on l.PROJECT_ID = c.COMPANYPROJECTS_ID
 where c.GROUP_ID = #{groupid}
 and l.LOG_DATE &gt;= #{startday}
 and l.LOG_DATE &lt;= #{endday}
group by MONTH(l.LOG_DATE)

) a
group by code

union all
select concat('worktime', if(e.VENUETARGET = '是','0','1')) as CODE, IFNULL(sum(APRIL),0) as actual4 ,IFNULL(sum(MAY),0) as actual5,IFNULL(sum(JUNE),0) as actual6,
IFNULL(sum(JULY),0) as actual7,IFNULL(sum(AUGUST),0) as actual8,
IFNULL(sum(SEPTEMBER),0) as actual9,IFNULL(sum(OCTOBER),0) as actual10,IFNULL(sum(NOVEMBER),0) as actual11,IFNULL(sum(DECEMBER),0) as actual12,
IFNULL(sum(JANUARY),0) as actual1, IFNULL(sum(FEBRUARY),0) as actual2, IFNULL(sum(MARCH),0) as actual3
from delegainformation d
inner join companyprojects c
on d.COMPANYPROJECTS_ID = c.COMPANYPROJECTS_ID
inner join projectsystem p
on d.PROJECTSYSTEM_ID = p.PROJECTSYSTEM_ID
inner join expatriatesinfor e
on p.SUPPLIERNAMEID = e.EXPATRIATESINFOR_ID
where c.GROUP_ID = #{groupid}
and d.year &gt;= #{startday}
and d.year &lt;= #{endday}
group by e.VENUETARGET

union all
select "neibu" as code,sum(cost.COST4) as actual4,sum(cost.COST5) as actual5,sum(cost.COST6) as actual6,sum(cost.COST7) as actual7,sum(cost.COST8) as actual8,sum(cost.COST9) as actual9,sum(cost.COST10) as actual10,sum(cost.COST11) as actual11,sum(cost.COST12) actual12,sum(cost.COST1) as actual1,sum(cost.COST2) as actual2,sum(cost.COST3) actual3
from coststatistics cost
inner join expatriatesinfor exp
  on cost.BPNAME = exp.EXPATRIATESINFOR_ID
inner join projectsystem ps
  on ps.`SUPPLIERNAMEID` = cost.bpname
inner join companyprojects cp
  on ps.COMPANYPROJECTS_ID = cp.COMPANYPROJECTS_ID
where cp.GROUP_ID = #{groupid}
group by cost.BPCOMPANY,code
    </select>

    <select id="getoneGroupA1" resultType="com.nt.dao_Pfans.PFANS1000.Vo.BusinessGroupA1Vo">
select
       t.contracttype AS name1,
       t.contracttype AS name2,
       SUM(AMOUNT4*m4.BUSINESSPLANEXCHANGERATE) AS money4,
       SUM(AMOUNT5*m5.BUSINESSPLANEXCHANGERATE) AS money5,
       SUM(AMOUNT6*m6.BUSINESSPLANEXCHANGERATE) AS money6,
       SUM(AMOUNT7*m7.BUSINESSPLANEXCHANGERATE) AS money7,
       SUM(AMOUNT8*m8.BUSINESSPLANEXCHANGERATE) AS money8,
       SUM(AMOUNT9*m9.BUSINESSPLANEXCHANGERATE) AS money9,
       SUM(AMOUNT10*m10.BUSINESSPLANEXCHANGERATE) AS money10,
       SUM(AMOUNT11*m11.BUSINESSPLANEXCHANGERATE) AS money11,
       SUM(AMOUNT12*m12.BUSINESSPLANEXCHANGERATE) AS money12,
       SUM(AMOUNT1*m1.BUSINESSPLANEXCHANGERATE) AS money1,
       SUM(AMOUNT2*m2.BUSINESSPLANEXCHANGERATE) AS money2,
       SUM(AMOUNT3*m3.BUSINESSPLANEXCHANGERATE) AS money3,
       SUM(AMOUNT4*m4.BUSINESSPLANEXCHANGERATE+AMOUNT5*m5.BUSINESSPLANEXCHANGERATE+AMOUNT6*m6.BUSINESSPLANEXCHANGERATE+AMOUNT7*m7.BUSINESSPLANEXCHANGERATE+AMOUNT8*m8.BUSINESSPLANEXCHANGERATE+AMOUNT9*m9.BUSINESSPLANEXCHANGERATE) AS moneyfirst,
       SUM(AMOUNT10*m10.BUSINESSPLANEXCHANGERATE+AMOUNT11*m11.BUSINESSPLANEXCHANGERATE+AMOUNT12*m12.BUSINESSPLANEXCHANGERATE+AMOUNT1*m1.BUSINESSPLANEXCHANGERATE+AMOUNT2*m2.BUSINESSPLANEXCHANGERATE+AMOUNT3*m3.BUSINESSPLANEXCHANGERATE) AS moneysecond,
       SUM(AMOUNT4*m4.BUSINESSPLANEXCHANGERATE+AMOUNT5*m5.BUSINESSPLANEXCHANGERATE+AMOUNT6*m6.BUSINESSPLANEXCHANGERATE+AMOUNT7*m7.BUSINESSPLANEXCHANGERATE+AMOUNT8*m8.BUSINESSPLANEXCHANGERATE+AMOUNT9*m9.BUSINESSPLANEXCHANGERATE+AMOUNT10*m10.BUSINESSPLANEXCHANGERATE+AMOUNT11*m11.BUSINESSPLANEXCHANGERATE+AMOUNT12*m12.BUSINESSPLANEXCHANGERATE+AMOUNT1*m1.BUSINESSPLANEXCHANGERATE+AMOUNT2*m2.BUSINESSPLANEXCHANGERATE+AMOUNT3*m3.BUSINESSPLANEXCHANGERATE) AS moneytotal
from themeplandetail t
left join monthlyrate m4
    on t.CURRENCYTYPE = m4.CURRENCY
    and m4.year = t.YEAR
    and m4.MONTH = concat(t.YEAR,'-','04')
left join monthlyrate m5
    on t.CURRENCYTYPE = m5.CURRENCY
    and m5.year = t.YEAR
    and m5.MONTH = concat(t.YEAR,'-','05')
left join monthlyrate m6
    on t.CURRENCYTYPE = m6.CURRENCY
    and m6.year = t.YEAR
    and m6.MONTH = concat(t.YEAR,'-','06')
left join monthlyrate m7
on t.CURRENCYTYPE = m7.CURRENCY
    and m7.year = t.YEAR
    and m7.MONTH = concat(t.YEAR,'-','07')
left join monthlyrate m8
on t.CURRENCYTYPE = m8.CURRENCY
    and m8.year = t.YEAR
    and m8.MONTH = concat(t.YEAR,'-','08')
left join monthlyrate m9
on t.CURRENCYTYPE = m9.CURRENCY
    and m9.year = t.YEAR
    and m9.MONTH = concat(t.YEAR,'-','09')
left join monthlyrate m10
on t.CURRENCYTYPE = m10.CURRENCY
    and m10.year = t.YEAR
    and m10.MONTH = concat(t.YEAR,'-','10')
left join monthlyrate m11
on t.CURRENCYTYPE = m11.CURRENCY
    and m11.year = t.YEAR
    and m11.MONTH = concat(t.YEAR,'-','11')
left join monthlyrate m12
on t.CURRENCYTYPE = m12.CURRENCY
    and m12.year = t.YEAR
    and m12.MONTH = concat(t.YEAR,'-','12')
left join monthlyrate m1
on t.CURRENCYTYPE = m1.CURRENCY
    and m1.year = t.YEAR
    and m1.MONTH = concat(t.YEAR + 1,'-','01')
left join monthlyrate m2
on t.CURRENCYTYPE = m2.CURRENCY
    and m2.year = t.YEAR
    and m2.MONTH = concat(t.YEAR + 1,'-','02')
left join monthlyrate m3
on t.CURRENCYTYPE = m3.CURRENCY
    and m3.year = t.YEAR
    and m3.MONTH = concat(t.YEAR + 1,'-','03')
where t.type = 0 and t.year = #{year} and t.contracttype = 'PJ142001' and t.center_id = #{groupid}
    </select>
    <select id="gettwoGroupA1" resultType="com.nt.dao_Pfans.PFANS1000.Vo.BusinessGroupA1Vo">
select
       t.contracttype AS name1,
       t.contracttype AS name2,
       SUM(AMOUNT4*m4.BUSINESSPLANEXCHANGERATE) AS money4,
       SUM(AMOUNT5*m5.BUSINESSPLANEXCHANGERATE) AS money5,
       SUM(AMOUNT6*m6.BUSINESSPLANEXCHANGERATE) AS money6,
       SUM(AMOUNT7*m7.BUSINESSPLANEXCHANGERATE) AS money7,
       SUM(AMOUNT8*m8.BUSINESSPLANEXCHANGERATE) AS money8,
       SUM(AMOUNT9*m9.BUSINESSPLANEXCHANGERATE) AS money9,
       SUM(AMOUNT10*m10.BUSINESSPLANEXCHANGERATE) AS money10,
       SUM(AMOUNT11*m11.BUSINESSPLANEXCHANGERATE) AS money11,
       SUM(AMOUNT12*m12.BUSINESSPLANEXCHANGERATE) AS money12,
       SUM(AMOUNT1*m1.BUSINESSPLANEXCHANGERATE) AS money1,
       SUM(AMOUNT2*m2.BUSINESSPLANEXCHANGERATE) AS money2,
       SUM(AMOUNT3*m3.BUSINESSPLANEXCHANGERATE) AS money3,
       SUM(AMOUNT4*m4.BUSINESSPLANEXCHANGERATE+AMOUNT5*m5.BUSINESSPLANEXCHANGERATE+AMOUNT6*m6.BUSINESSPLANEXCHANGERATE+AMOUNT7*m7.BUSINESSPLANEXCHANGERATE+AMOUNT8*m8.BUSINESSPLANEXCHANGERATE+AMOUNT9*m9.BUSINESSPLANEXCHANGERATE) AS moneyfirst,
       SUM(AMOUNT10*m10.BUSINESSPLANEXCHANGERATE+AMOUNT11*m11.BUSINESSPLANEXCHANGERATE+AMOUNT12*m12.BUSINESSPLANEXCHANGERATE+AMOUNT1*m1.BUSINESSPLANEXCHANGERATE+AMOUNT2*m2.BUSINESSPLANEXCHANGERATE+AMOUNT3*m3.BUSINESSPLANEXCHANGERATE) AS moneysecond,
       SUM(AMOUNT4*m4.BUSINESSPLANEXCHANGERATE+AMOUNT5*m5.BUSINESSPLANEXCHANGERATE+AMOUNT6*m6.BUSINESSPLANEXCHANGERATE+AMOUNT7*m7.BUSINESSPLANEXCHANGERATE+AMOUNT8*m8.BUSINESSPLANEXCHANGERATE+AMOUNT9*m9.BUSINESSPLANEXCHANGERATE+AMOUNT10*m10.BUSINESSPLANEXCHANGERATE+AMOUNT11*m11.BUSINESSPLANEXCHANGERATE+AMOUNT12*m12.BUSINESSPLANEXCHANGERATE+AMOUNT1*m1.BUSINESSPLANEXCHANGERATE+AMOUNT2*m2.BUSINESSPLANEXCHANGERATE+AMOUNT3*m3.BUSINESSPLANEXCHANGERATE) AS moneytotal
from themeplandetail t
left join monthlyrate m4
    on t.CURRENCYTYPE = m4.CURRENCY
    and m4.year = t.YEAR
    and m4.MONTH = concat(t.YEAR,'-','04')
left join monthlyrate m5
    on t.CURRENCYTYPE = m5.CURRENCY
    and m5.year = t.YEAR
    and m5.MONTH = concat(t.YEAR,'-','05')
left join monthlyrate m6
    on t.CURRENCYTYPE = m6.CURRENCY
    and m6.year = t.YEAR
    and m6.MONTH = concat(t.YEAR,'-','06')
left join monthlyrate m7
on t.CURRENCYTYPE = m7.CURRENCY
    and m7.year = t.YEAR
    and m7.MONTH = concat(t.YEAR,'-','07')
left join monthlyrate m8
on t.CURRENCYTYPE = m8.CURRENCY
    and m8.year = t.YEAR
    and m8.MONTH = concat(t.YEAR,'-','08')
left join monthlyrate m9
on t.CURRENCYTYPE = m9.CURRENCY
    and m9.year = t.YEAR
    and m9.MONTH = concat(t.YEAR,'-','09')
left join monthlyrate m10
on t.CURRENCYTYPE = m10.CURRENCY
    and m10.year = t.YEAR
    and m10.MONTH = concat(t.YEAR,'-','10')
left join monthlyrate m11
on t.CURRENCYTYPE = m11.CURRENCY
    and m11.year = t.YEAR
    and m11.MONTH = concat(t.YEAR,'-','11')
left join monthlyrate m12
on t.CURRENCYTYPE = m12.CURRENCY
    and m12.year = t.YEAR
    and m12.MONTH = concat(t.YEAR,'-','12')
left join monthlyrate m1
on t.CURRENCYTYPE = m1.CURRENCY
    and m1.year = t.YEAR
    and m1.MONTH = concat(t.YEAR + 1,'-','01')
left join monthlyrate m2
on t.CURRENCYTYPE = m2.CURRENCY
    and m2.year = t.YEAR
    and m2.MONTH = concat(t.YEAR + 1,'-','02')
left join monthlyrate m3
on t.CURRENCYTYPE = m3.CURRENCY
    and m3.year = t.YEAR
    and m3.MONTH = concat(t.YEAR + 1,'-','03')
where t.type = 0 and t.year = #{year} and t.contracttype = 'PJ142002' and t.center_id = #{groupid}
    </select>
    <select id="getthreeGroupA1" resultType="com.nt.dao_Pfans.PFANS1000.Vo.BusinessGroupA1Vo">
select
       t.contracttype AS name1,
       t.contracttype AS name2,
       SUM(AMOUNT4*m4.BUSINESSPLANEXCHANGERATE) AS money4,
       SUM(AMOUNT5*m5.BUSINESSPLANEXCHANGERATE) AS money5,
       SUM(AMOUNT6*m6.BUSINESSPLANEXCHANGERATE) AS money6,
       SUM(AMOUNT7*m7.BUSINESSPLANEXCHANGERATE) AS money7,
       SUM(AMOUNT8*m8.BUSINESSPLANEXCHANGERATE) AS money8,
       SUM(AMOUNT9*m9.BUSINESSPLANEXCHANGERATE) AS money9,
       SUM(AMOUNT10*m10.BUSINESSPLANEXCHANGERATE) AS money10,
       SUM(AMOUNT11*m11.BUSINESSPLANEXCHANGERATE) AS money11,
       SUM(AMOUNT12*m12.BUSINESSPLANEXCHANGERATE) AS money12,
       SUM(AMOUNT1*m1.BUSINESSPLANEXCHANGERATE) AS money1,
       SUM(AMOUNT2*m2.BUSINESSPLANEXCHANGERATE) AS money2,
       SUM(AMOUNT3*m3.BUSINESSPLANEXCHANGERATE) AS money3,
       SUM(AMOUNT4*m4.BUSINESSPLANEXCHANGERATE+AMOUNT5*m5.BUSINESSPLANEXCHANGERATE+AMOUNT6*m6.BUSINESSPLANEXCHANGERATE+AMOUNT7*m7.BUSINESSPLANEXCHANGERATE+AMOUNT8*m8.BUSINESSPLANEXCHANGERATE+AMOUNT9*m9.BUSINESSPLANEXCHANGERATE) AS moneyfirst,
       SUM(AMOUNT10*m10.BUSINESSPLANEXCHANGERATE+AMOUNT11*m11.BUSINESSPLANEXCHANGERATE+AMOUNT12*m12.BUSINESSPLANEXCHANGERATE+AMOUNT1*m1.BUSINESSPLANEXCHANGERATE+AMOUNT2*m2.BUSINESSPLANEXCHANGERATE+AMOUNT3*m3.BUSINESSPLANEXCHANGERATE) AS moneysecond,
       SUM(AMOUNT4*m4.BUSINESSPLANEXCHANGERATE+AMOUNT5*m5.BUSINESSPLANEXCHANGERATE+AMOUNT6*m6.BUSINESSPLANEXCHANGERATE+AMOUNT7*m7.BUSINESSPLANEXCHANGERATE+AMOUNT8*m8.BUSINESSPLANEXCHANGERATE+AMOUNT9*m9.BUSINESSPLANEXCHANGERATE+AMOUNT10*m10.BUSINESSPLANEXCHANGERATE+AMOUNT11*m11.BUSINESSPLANEXCHANGERATE+AMOUNT12*m12.BUSINESSPLANEXCHANGERATE+AMOUNT1*m1.BUSINESSPLANEXCHANGERATE+AMOUNT2*m2.BUSINESSPLANEXCHANGERATE+AMOUNT3*m3.BUSINESSPLANEXCHANGERATE) AS moneytotal
from themeplandetail t
left join monthlyrate m4
    on t.CURRENCYTYPE = m4.CURRENCY
    and m4.year = t.YEAR
    and m4.MONTH = concat(t.YEAR,'-','04')
left join monthlyrate m5
    on t.CURRENCYTYPE = m5.CURRENCY
    and m5.year = t.YEAR
    and m5.MONTH = concat(t.YEAR,'-','05')
left join monthlyrate m6
    on t.CURRENCYTYPE = m6.CURRENCY
    and m6.year = t.YEAR
    and m6.MONTH = concat(t.YEAR,'-','06')
left join monthlyrate m7
on t.CURRENCYTYPE = m7.CURRENCY
    and m7.year = t.YEAR
    and m7.MONTH = concat(t.YEAR,'-','07')
left join monthlyrate m8
on t.CURRENCYTYPE = m8.CURRENCY
    and m8.year = t.YEAR
    and m8.MONTH = concat(t.YEAR,'-','08')
left join monthlyrate m9
on t.CURRENCYTYPE = m9.CURRENCY
    and m9.year = t.YEAR
    and m9.MONTH = concat(t.YEAR,'-','09')
left join monthlyrate m10
on t.CURRENCYTYPE = m10.CURRENCY
    and m10.year = t.YEAR
    and m10.MONTH = concat(t.YEAR,'-','10')
left join monthlyrate m11
on t.CURRENCYTYPE = m11.CURRENCY
    and m11.year = t.YEAR
    and m11.MONTH = concat(t.YEAR,'-','11')
left join monthlyrate m12
on t.CURRENCYTYPE = m12.CURRENCY
    and m12.year = t.YEAR
    and m12.MONTH = concat(t.YEAR,'-','12')
left join monthlyrate m1
on t.CURRENCYTYPE = m1.CURRENCY
    and m1.year = t.YEAR
    and m1.MONTH = concat(t.YEAR + 1,'-','01')
left join monthlyrate m2
on t.CURRENCYTYPE = m2.CURRENCY
    and m2.year = t.YEAR
    and m2.MONTH = concat(t.YEAR + 1,'-','02')
left join monthlyrate m3
on t.CURRENCYTYPE = m3.CURRENCY
    and m3.year = t.YEAR
    and m3.MONTH = concat(t.YEAR + 1,'-','03')
where t.type = 0 and t.year = #{year} and t.contracttype = 'PJ142003' and t.center_id = #{groupid}
    </select>
    <select id="getgroupA2" resultType="com.nt.dao_Pfans.PFANS1000.Vo.BusinessGroupA2Vo">
select
ASSIGNOR as groupname,
SUM(PERSONNEL4) AS number4,
SUM(PERSONNEL5) AS number5,
SUM(PERSONNEL6) AS number6,
SUM(PERSONNEL7) AS number7,
SUM(PERSONNEL8) AS number8,
SUM(PERSONNEL9) AS number9,
SUM(PERSONNEL10) AS number10,
SUM(PERSONNEL11) AS number11,
SUM(PERSONNEL12) AS number12,
SUM(PERSONNEL1) AS number1,
SUM(PERSONNEL2) AS number2,
SUM(PERSONNEL3) AS number3,
SUM(PERSONNEL4+PERSONNEL5+PERSONNEL6+PERSONNEL7+PERSONNEL8+PERSONNEL9) AS numberfirst,
SUM(PERSONNEL10+PERSONNEL11+PERSONNEL12+PERSONNEL1+PERSONNEL2+PERSONNEL3) AS numbersecond,
SUM(PERSONNEL4+PERSONNEL5+PERSONNEL6+PERSONNEL7+PERSONNEL8+PERSONNEL9+PERSONNEL10+PERSONNEL11+PERSONNEL12+PERSONNEL1+PERSONNEL2+PERSONNEL3) AS numbertotal,
SUM(AMOUNT4) AS money4,
SUM(AMOUNT5) AS money5,
SUM(AMOUNT6) AS money6,
SUM(AMOUNT7) AS money7,
SUM(AMOUNT8) AS money8,
SUM(AMOUNT9) AS money9,
SUM(AMOUNT10) AS money10,
SUM(AMOUNT11) AS money11,
SUM(AMOUNT12) AS money12,
SUM(AMOUNT1) AS money1,
SUM(AMOUNT2) AS money2,
SUM(AMOUNT3) AS money3,
SUM(AMOUNT4+AMOUNT5+AMOUNT6+AMOUNT7+AMOUNT8+AMOUNT9) AS moneyfirst,
SUM(AMOUNT10+AMOUNT11+AMOUNT12+AMOUNT1+AMOUNT2+AMOUNT3) AS moneysecond,
SUM(AMOUNT4+AMOUNT5+AMOUNT6+AMOUNT7+AMOUNT8+AMOUNT9+AMOUNT10+AMOUNT11+AMOUNT12+AMOUNT1+AMOUNT2+AMOUNT3) AS moneytotal
from themeplandetail where type = 0 and (contracttype = 'PJ142004' or contracttype = 'PJ142005' ) and year = #{year} and center_id = #{groupid} group by ASSIGNOR
    </select>
    <select id="getgroupB1" resultType="com.nt.dao_Pfans.PFANS1000.Vo.BusinessGroupA2Vo">
select
ASSIGNOR as groupname,
SUM(PERSONNEL4) AS number4,
SUM(PERSONNEL5) AS number5,
SUM(PERSONNEL6) AS number6,
SUM(PERSONNEL7) AS number7,
SUM(PERSONNEL8) AS number8,
SUM(PERSONNEL9) AS number9,
SUM(PERSONNEL10) AS number10,
SUM(PERSONNEL11) AS number11,
SUM(PERSONNEL12) AS number12,
SUM(PERSONNEL1) AS number1,
SUM(PERSONNEL2) AS number2,
SUM(PERSONNEL3) AS number3,
SUM(PERSONNEL4+PERSONNEL5+PERSONNEL6+PERSONNEL7+PERSONNEL8+PERSONNEL9) AS numberfirst,
SUM(PERSONNEL10+PERSONNEL11+PERSONNEL12+PERSONNEL1+PERSONNEL2+PERSONNEL3) AS numbersecond,
SUM(PERSONNEL4+PERSONNEL5+PERSONNEL6+PERSONNEL7+PERSONNEL8+PERSONNEL9+PERSONNEL10+PERSONNEL11+PERSONNEL12+PERSONNEL1+PERSONNEL2+PERSONNEL3) AS numbertotal,
SUM(AMOUNT4) AS money4,
SUM(AMOUNT5) AS money5,
SUM(AMOUNT6) AS money6,
SUM(AMOUNT7) AS money7,
SUM(AMOUNT8) AS money8,
SUM(AMOUNT9) AS money9,
SUM(AMOUNT10) AS money10,
SUM(AMOUNT11) AS money11,
SUM(AMOUNT12) AS money12,
SUM(AMOUNT1) AS money1,
SUM(AMOUNT2) AS money2,
SUM(AMOUNT3) AS money3,
SUM(AMOUNT4+AMOUNT5+AMOUNT6+AMOUNT7+AMOUNT8+AMOUNT9) AS moneyfirst,
SUM(AMOUNT10+AMOUNT11+AMOUNT12+AMOUNT1+AMOUNT2+AMOUNT3) AS moneysecond,
SUM(AMOUNT4+AMOUNT5+AMOUNT6+AMOUNT7+AMOUNT8+AMOUNT9+AMOUNT10+AMOUNT11+AMOUNT12+AMOUNT1+AMOUNT2+AMOUNT3) AS moneytotal
from themeplandetail where type = 1 and contracttype = 'PJ142006' and year = #{year} and center_id = #{groupid} group by ASSIGNOR
    </select>
    <select id="getgroupB2" resultType="com.nt.dao_Pfans.PFANS1000.Vo.BusinessGroupA2Vo">
select
ASSIGNOR as groupname,
SUM(PERSONNEL4) AS number4,
SUM(PERSONNEL5) AS number5,
SUM(PERSONNEL6) AS number6,
SUM(PERSONNEL7) AS number7,
SUM(PERSONNEL8) AS number8,
SUM(PERSONNEL9) AS number9,
SUM(PERSONNEL10) AS number10,
SUM(PERSONNEL11) AS number11,
SUM(PERSONNEL12) AS number12,
SUM(PERSONNEL1) AS number1,
SUM(PERSONNEL2) AS number2,
SUM(PERSONNEL3) AS number3,
SUM(PERSONNEL4+PERSONNEL5+PERSONNEL6+PERSONNEL7+PERSONNEL8+PERSONNEL9) AS numberfirst,
SUM(PERSONNEL10+PERSONNEL11+PERSONNEL12+PERSONNEL1+PERSONNEL2+PERSONNEL3) AS numbersecond,
SUM(PERSONNEL4+PERSONNEL5+PERSONNEL6+PERSONNEL7+PERSONNEL8+PERSONNEL9+PERSONNEL10+PERSONNEL11+PERSONNEL12+PERSONNEL1+PERSONNEL2+PERSONNEL3) AS numbertotal,
SUM(AMOUNT4) AS money4,
SUM(AMOUNT5) AS money5,
SUM(AMOUNT6) AS money6,
SUM(AMOUNT7) AS money7,
SUM(AMOUNT8) AS money8,
SUM(AMOUNT9) AS money9,
SUM(AMOUNT10) AS money10,
SUM(AMOUNT11) AS money11,
SUM(AMOUNT12) AS money12,
SUM(AMOUNT1) AS money1,
SUM(AMOUNT2) AS money2,
SUM(AMOUNT3) AS money3,
SUM(AMOUNT4+AMOUNT5+AMOUNT6+AMOUNT7+AMOUNT8+AMOUNT9) AS moneyfirst,
SUM(AMOUNT10+AMOUNT11+AMOUNT12+AMOUNT1+AMOUNT2+AMOUNT3) AS moneysecond,
SUM(AMOUNT4+AMOUNT5+AMOUNT6+AMOUNT7+AMOUNT8+AMOUNT9+AMOUNT10+AMOUNT11+AMOUNT12+AMOUNT1+AMOUNT2+AMOUNT3) AS moneytotal
from themeplandetail where type = 1 and contracttype = 'PJ142007' and year = #{year} and center_id = #{groupid} group by ASSIGNOR
    </select>
    <select id="getgroupB3" resultType="com.nt.dao_Pfans.PFANS1000.Vo.BusinessGroupA2Vo">
select
ASSIGNOR as groupname,
SUM(PERSONNEL4) AS number4,
SUM(PERSONNEL5) AS number5,
SUM(PERSONNEL6) AS number6,
SUM(PERSONNEL7) AS number7,
SUM(PERSONNEL8) AS number8,
SUM(PERSONNEL9) AS number9,
SUM(PERSONNEL10) AS number10,
SUM(PERSONNEL11) AS number11,
SUM(PERSONNEL12) AS number12,
SUM(PERSONNEL1) AS number1,
SUM(PERSONNEL2) AS number2,
SUM(PERSONNEL3) AS number3,
SUM(PERSONNEL4+PERSONNEL5+PERSONNEL6+PERSONNEL7+PERSONNEL8+PERSONNEL9) AS numberfirst,
SUM(PERSONNEL10+PERSONNEL11+PERSONNEL12+PERSONNEL1+PERSONNEL2+PERSONNEL3) AS numbersecond,
SUM(PERSONNEL4+PERSONNEL5+PERSONNEL6+PERSONNEL7+PERSONNEL8+PERSONNEL9+PERSONNEL10+PERSONNEL11+PERSONNEL12+PERSONNEL1+PERSONNEL2+PERSONNEL3) AS numbertotal,
SUM(AMOUNT4) AS money4,
SUM(AMOUNT5) AS money5,
SUM(AMOUNT6) AS money6,
SUM(AMOUNT7) AS money7,
SUM(AMOUNT8) AS money8,
SUM(AMOUNT9) AS money9,
SUM(AMOUNT10) AS money10,
SUM(AMOUNT11) AS money11,
SUM(AMOUNT12) AS money12,
SUM(AMOUNT1) AS money1,
SUM(AMOUNT2) AS money2,
SUM(AMOUNT3) AS money3,
SUM(AMOUNT4+AMOUNT5+AMOUNT6+AMOUNT7+AMOUNT8+AMOUNT9) AS moneyfirst,
SUM(AMOUNT10+AMOUNT11+AMOUNT12+AMOUNT1+AMOUNT2+AMOUNT3) AS moneysecond,
SUM(AMOUNT4+AMOUNT5+AMOUNT6+AMOUNT7+AMOUNT8+AMOUNT9+AMOUNT10+AMOUNT11+AMOUNT12+AMOUNT1+AMOUNT2+AMOUNT3) AS moneytotal
from themeplandetail where type = 1 and (contracttype = 'PJ142008' or contracttype = 'PJ142009' ) and year = #{year} and center_id = #{groupid} group by ASSIGNOR
    </select>
</mapper>

