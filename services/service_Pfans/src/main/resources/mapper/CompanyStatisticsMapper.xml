<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.nt.service_pfans.PFANS6000.mapper.CompanyStatisticsMapper">

	<select id="getWorkTimes" parameterType="map" resultType="com.nt.dao_Pfans.PFANS6000.CompanyStatistics">
		select a.SUPPLIERNAME as bpcompany,
		IFNULL(a.JANUARY,0) as manhour1, IFNULL(a.FEBRUARY,0) as manhour2, IFNULL(a.MARCH,0) as manhour3, IFNULL(a.APRIL,0) as manhour4, IFNULL(a.MAY,0) as manhour5, IFNULL(a.JUNE,0) as manhour6,
		IFNULL(a.JULY,0) as manhour7, IFNULL(a.AUGUST,0) as manhour8, IFNULL(a.SEPTEMBER,0) as manhour9, IFNULL(a.OCTOBER,0) as manhour10, IFNULL(a.NOVEMBER,0) as manhour11, IFNULL(a.DECEMBER,0) as manhour12,
		IFNULL(b.JANUARY,0) as cost1, IFNULL(b.FEBRUARY,0) as cost2, IFNULL(b.MARCH,0) as cost3, IFNULL(b.APRIL,0) as cost4, IFNULL(b.MAY,0) as cost5, IFNULL(b.JUNE,0) as cost6,
		IFNULL(b.JULY,0) as cost7, IFNULL(b.AUGUST,0) as cost8, IFNULL(b.SEPTEMBER,0) as cost9, IFNULL(b.OCTOBER,0) as cost10, IFNULL(b.NOVEMBER,0) as cost11, IFNULL(b.DECEMBER,0) as cost12
		 from
		(
			select exp.SUPPLIERNAME, sum(exp.`JANUARY`) as JANUARY, sum(exp.FEBRUARY) as FEBRUARY, sum(exp.MARCH) as MARCH, sum(exp.APRIL) as APRIL, sum(exp.MAY) as MAY, sum(exp.JUNE) as JUNE,
					sum(exp.`JULY`) as JULY, sum(exp.AUGUST) as AUGUST, sum(exp.SEPTEMBER) as SEPTEMBER, sum(exp.OCTOBER) as OCTOBER, sum(exp.NOVEMBER) as NOVEMBER, sum(exp.DECEMBER) as DECEMBER
					from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			group by SUPPLIERNAME
		) a
		left join (
			select exp.SUPPLIERNAME, sum(exp.`JANUARY`) as JANUARY, sum(exp.FEBRUARY) as FEBRUARY, sum(exp.MARCH) as MARCH, sum(exp.APRIL) as APRIL, sum(exp.MAY) as MAY, sum(exp.JUNE) as JUNE,
					sum(exp.`JULY`) as JULY, sum(exp.AUGUST) as AUGUST, sum(exp.SEPTEMBER) as SEPTEMBER, sum(exp.OCTOBER) as OCTOBER, sum(exp.NOVEMBER) as NOVEMBER, sum(exp.DECEMBER) as DECEMBER
					from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{noValue}
			group by SUPPLIERNAME
		) b
		on a.SUPPLIERNAME = b.SUPPLIERNAME
	</select>

	<select id="getWorkers" parameterType="map" resultType="com.nt.dao_Pfans.PFANS6000.CompanyStatistics">
		select a.SUPPLIERNAME as bpcompany, IFNULL(a.JANUARY,0) as manhour1, IFNULL(b.FEBRUARY,0) as manhour2, IFNULL(c.MARCH,0) as manhour3, IFNULL(d.APRIL,0) as manhour4, IFNULL(e.MAY,0) as manhour5,
		IFNULL(f.JUNE,0) as manhour6, IFNULL(g.JULY,0) as manhour7,IFNULL(h.AUGUST,0) as manhour8, IFNULL(i.SEPTEMBER,0) as manhour9, IFNULL(j.OCTOBER,0) as manhour10, IFNULL(k.NOVEMBER,0) as manhour11,
		IFNULL(l.DECEMBER,0) as manhour12
		from (
			select exp.SUPPLIERNAME, count(exp.`JANUARY`) as JANUARY
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`JANUARY` != '0'
			group by SUPPLIERNAME
		) a
		left join(
			select exp.SUPPLIERNAME, count(exp.`FEBRUARY`) as FEBRUARY
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`FEBRUARY` != '0'
			group by SUPPLIERNAME
		) b
		on a.SUPPLIERNAME = b.SUPPLIERNAME
		left join(
			select exp.SUPPLIERNAME, count(exp.`MARCH`) as MARCH
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`MARCH` != '0'
			group by SUPPLIERNAME
		) c
		on a.SUPPLIERNAME = c.SUPPLIERNAME
		left join(
			select exp.SUPPLIERNAME, count(exp.`APRIL`) as APRIL
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`APRIL` != '0'
			group by SUPPLIERNAME
		) d
		on a.SUPPLIERNAME = d.SUPPLIERNAME
		left join(
			select exp.SUPPLIERNAME, count(exp.`MAY`) as MAY
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`MAY` != '0'
			group by SUPPLIERNAME
		) e
		on a.SUPPLIERNAME = e.SUPPLIERNAME
		left join(
			select exp.SUPPLIERNAME, count(exp.`JUNE`) as JUNE
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`JUNE` != '0'
			group by SUPPLIERNAME
		) f
		on a.SUPPLIERNAME = f.SUPPLIERNAME
		left join(
			select exp.SUPPLIERNAME, count(exp.`JULY`) as JULY
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`JULY` != '0'
			group by SUPPLIERNAME
		) g
		on a.SUPPLIERNAME = g.SUPPLIERNAME
		left join(
			select exp.SUPPLIERNAME, count(exp.`AUGUST`) as AUGUST
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`AUGUST` != '0'
			group by SUPPLIERNAME
		) h
		on a.SUPPLIERNAME = h.SUPPLIERNAME
		left join(
			select exp.SUPPLIERNAME, count(exp.`SEPTEMBER`) as SEPTEMBER
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`SEPTEMBER` != '0'
			group by SUPPLIERNAME
		) i
		on a.SUPPLIERNAME = i.SUPPLIERNAME
		left join(
			select exp.SUPPLIERNAME, count(exp.`OCTOBER`) as OCTOBER
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`OCTOBER` != '0'
			group by SUPPLIERNAME
		) j
		on a.SUPPLIERNAME = j.SUPPLIERNAME
		left join(
			select exp.SUPPLIERNAME, count(exp.`NOVEMBER`) as NOVEMBER
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`NOVEMBER` != '0'
			group by SUPPLIERNAME
		) k
		on a.SUPPLIERNAME = k.SUPPLIERNAME
		left join(
			select exp.SUPPLIERNAME, count(exp.`DECEMBER`) as DECEMBER
			from `expatriatesinfor` exp
			where
			1 = 1
			<if test="owner!=null">
				and OWNER = #{owner}
			</if>
			and VENUETARGET = #{yesValue}
			and exp.`DECEMBER` != '0'
			group by SUPPLIERNAME
		) l
		on a.SUPPLIERNAME = l.SUPPLIERNAME
	</select>
</mapper>
