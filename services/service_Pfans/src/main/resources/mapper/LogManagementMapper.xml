<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.nt.service_pfans.PFANS5000.mapper.LogManagementMapper">
	<select id="getDataList" resultType="com.nt.dao_Pfans.PFANS5000.LogManagement">
		SELECT * FROM (
			SELECT * FROM  logmanagement
			)a
		ORDER BY a.log_date,a.TIME_START;
	</select>
	<select id="gettlist" resultType="com.nt.dao_Pfans.PFANS5000.LogManagement">
		select * from logmanagement where HAS_PROJECT = '02' ;
	</select>

	<select id="getTimestart" resultType="com.nt.dao_Pfans.PFANS5000.Vo.LogmanagementStatusVo">
	select  info.createby,group_concat(info.logdate) as logdate ,group_concat(info.timestart) as timestart
	from  (
		select createby,date_format(log_date,'%Y-%m-%d') as logdate,sum(time_start) as timestart
	 	from logmanagement
	 	where project_id = #{project_id}
	 	and confirmstatus = '0'
		group by createby,log_date
	 ) info
	group by  info.createby
	</select>

    <select id="updateTimestart">
	 	update logmanagement set confirmstatus = #{confirmstatus}
		where
		createby = #{createby}
	    and date_format(LOG_DATE, '%Y-%m-%d')
	    between str_to_date(#{starttime}, '%Y-%m-%d %H') and str_to_date(#{endtime}, '%Y-%m-%d %H')
	</select>

</mapper>
